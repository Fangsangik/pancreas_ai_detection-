# ì·Œì¥ì•” ì¡°ê¸° ì§„ë‹¨ AI - Stage 1 Detection System

**ë‹¤ë¥¸ ëª©ì ìœ¼ë¡œ ì°ì€ CTì—ì„œ ì·Œì¥ì•”ì„ ì¡°ê¸°ì— ë°œê²¬í•˜ëŠ” AI ì‹œìŠ¤í…œ**

ì •ìƒ ì·Œì¥ì˜ ë¯¸ì„¸í•œ ë³€í™”ë¥¼ ê°ì§€í•˜ì—¬ ì¦ìƒì´ ë‚˜íƒ€ë‚˜ê¸° ì „, Stage 1-2ì—ì„œ ì·Œì¥ì•”ì„ ë°œê²¬í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.

---

## ğŸ¥ ì„ìƒì  ë°°ê²½ (Clinical Background)

### ì™œ Stage 1 ì¡°ê¸° ë°œê²¬ì´ ì¤‘ìš”í•œê°€?

ì·Œì¥ì•”ì€ ì§„ë‹¨ ì‹œì ì˜ ë³‘ê¸°(Stage)ì— ë”°ë¼ ìƒì¡´ìœ¨ì´ ê·¹ì ìœ¼ë¡œ ë‹¬ë¼ì§‘ë‹ˆë‹¤:

| ë³‘ê¸° | 5ë…„ ìƒì¡´ìœ¨ | CT ë°œê²¬ ì‹œ |
|------|-----------|-----------|
| **Stage 1** (T1N0M0, <2cm) | **~80%** | ê±°ì˜ ë¶ˆê°€ëŠ¥ âŒ |
| **Stage 2** (T2-3, 2-4cm) | ~30% | ë§¤ìš° ì–´ë ¤ì›€ |
| **Stage 3-4** (êµ­ì†Œ ì§„í–‰/ì „ì´) | **<5%** | **ëŒ€ë¶€ë¶„ ì—¬ê¸°ì„œ ë°œê²¬** âœ“ |

**í˜„ì‹¤:** CTì—ì„œ ì·Œì¥ì•”ì´ ë°œê²¬ë  ë•ŒëŠ” ëŒ€ë¶€ë¶„ ì´ë¯¸ Stage 3-4ì…ë‹ˆë‹¤.

### CTì—ì„œ ì¡°ê¸° ë°œê²¬ì´ ì–´ë ¤ìš´ ì´ìœ 

1. **ëŒ€ë¹„ë„(Contrast) ë¬¸ì œ**
   - 1-2cm ì´í•˜ì˜ ì‘ì€ ì¢…ì–‘ì€ ì •ìƒ ì·Œì¥ ì¡°ì§ê³¼ ë°€ë„ ì°¨ì´ê°€ ê±°ì˜ ì—†ìŒ
   - ì¼ë°˜ ë³µë¶€ CTëŠ” ì·Œì¥ì— ìµœì í™”ëœ íƒ€ì´ë°ì´ ì•„ë‹˜

2. **ì¦ìƒì˜ ë¶€ì¬**
   - Stage 1-2: ì¦ìƒì´ ê±°ì˜ ì—†ìŒ â†’ ê²€ì‚¬ ìì²´ë¥¼ ì•ˆ í•¨
   - **í™©ë‹¬ ì¦ìƒ**: ë‹´ê´€ì´ ë§‰í˜€ì•¼ ë‚˜íƒ€ë‚¨ â†’ ì´ë¯¸ Stage 3-4

3. **ê²€ì§„ì˜ í•œê³„**
   - ê±´ê°•ê²€ì§„: ì£¼ë¡œ ë³µë¶€ ì´ˆìŒíŒŒ (ì·Œì¥ ê´€ì°°ë¥  50-70%)
   - ê±´ê°•ê²€ì§„ì—ì„œ CTë¥¼ ì°ëŠ” ê²½ìš°: **<5%**
   - CTëŠ” ì£¼ë¡œ "ì¦ìƒì´ ìˆì–´ì„œ" ì°íŒë‹¤ â†’ ê·¸ë•ŒëŠ” ì´ë¯¸ ëŠ¦ìŒ

### ì‹¤ì œ CTê°€ ì°íˆëŠ” ê²½ìš°

CTëŠ” ê±´ê°•ê²€ì§„ë³´ë‹¤ëŠ” ë‹¤ìŒ ìƒí™©ì—ì„œ ì£¼ë¡œ ì°í™ë‹ˆë‹¤:

1. **ì¦ìƒìœ¼ë¡œ ì¸í•œ ì™¸ë˜/ì‘ê¸‰ì‹¤ ë°©ë¬¸**
   - ë³µí†µ, ì†Œí™”ë¶ˆëŸ‰, ì²´ì¤‘ ê°ì†Œ, í™©ë‹¬
   - ë‹¤ë¥¸ ì¥ê¸°(ê°„, ë‹´ë‚­, ìœ„ì¥) í‰ê°€ ëª©ì 
   - ì·Œì¥ì€ ë¶€ìˆ˜ì ìœ¼ë¡œë§Œ ê´€ì°°ë¨

2. **íƒ€ ì§ˆí™˜ ì •ê¸° ì¶”ì  ê´€ì°°**
   - ê°„ì§ˆí™˜, ì‹ ì¥ì§ˆí™˜, ëŒ€ì¥ì•” ìˆ˜ìˆ  í›„ ì¶”ì 
   - ë§¤ë…„ ì •ê¸° CTë¥¼ ì°ì§€ë§Œ ì·Œì¥ì€ ì„¸ë°€íˆ ì•ˆ ë´„

3. **ì™¸ìƒ/ìˆ˜ìˆ  ì „ í‰ê°€**
   - ì·Œì¥ì€ ì£¼ ê´€ì‹¬ì‚¬ê°€ ì•„ë‹˜

**ğŸ’¡ í•µì‹¬ ì¸ì‚¬ì´íŠ¸:** í•œêµ­ì—ì„œë§Œ ì—°ê°„ **500ë§Œ+ ë³µë¶€ CT**ê°€ ì°íˆê³  ìˆì§€ë§Œ, ëŒ€ë¶€ë¶„ ì·Œì¥ì€ "ëŒ€ì¶©" ë´…ë‹ˆë‹¤. ì´ê²ƒì´ ë°”ë¡œ AIì˜ ê¸°íšŒì…ë‹ˆë‹¤.

---

## ğŸ¯ í”„ë¡œì íŠ¸ì˜ ëª©í‘œì™€ ê°€ì¹˜

### Opportunistic Pancreatic Cancer Screening

**"ë‹¤ë¥¸ ëª©ì ìœ¼ë¡œ ì°ì€ CTì—ì„œ ì·Œì¥ë„ ìë™ìœ¼ë¡œ ì •ë°€ ë¶„ì„"**

#### ì‹œë‚˜ë¦¬ì˜¤ A: ì¦ìƒ í‰ê°€ ì¤‘ ìš°ì—°í•œ ë°œê²¬
```
í™˜ì: "ì†Œí™”ê°€ ì•ˆ ë˜ê³  ë°°ê°€ ë”ë¶€ë£©í•´ìš”"
ì˜ì‚¬: ë³µë¶€ CT ì²˜ë°© (ìœ„/ë‹´ë‚­ í‰ê°€ ëª©ì )
ë°©ì‚¬ì„ ê³¼: "íŠ¹ì´ ì†Œê²¬ ì—†ìŒ" (ì·Œì¥ì€ ê°„ë‹¨íˆë§Œ ë´„)

â†’ AI ì ìš© â­
   "ì·Œì¥ body ë¶€ìœ„ì— subtle texture heterogeneity ê°ì§€"
   "Confidence: 68%, ì·Œì¥ ì „ìš© CT ë˜ëŠ” MRI ê¶Œì¥"

â†’ ì¶”ê°€ ì •ë°€ ê²€ì‚¬ â†’ Stage 1 (1.5cm) ë°œê²¬
â†’ ìˆ˜ìˆ  ê°€ëŠ¥, ì™„ì¹˜ ê¸°íšŒ
```

#### ì‹œë‚˜ë¦¬ì˜¤ B: ì •ê¸° ì¶”ì  ê´€ì°° ì¤‘ ì¡°ê¸° ë°œê²¬
```
í™˜ì: ê°„ê²½í™” ì¶”ì  ê´€ì°° (6ê°œì›”ë§ˆë‹¤ CT)

â†’ AIì˜ Longitudinal Analysis â­
   "3íšŒ ì—°ì† CT ë¹„êµ ë¶„ì„"
   "ì·Œì¥ ë‘ë¶€(head) ì˜ì—­ì—ì„œ progressive texture change"
   "í¬ê¸° ë³€í™”ëŠ” ì—†ì§€ë§Œ attenuation pattern ë³€í™” ê°ì§€"

â†’ Dedicated pancreas protocol CT
â†’ Stage 1 ë°œê²¬ (ì¦ìƒ ë‚˜íƒ€ë‚˜ê¸° ì „)
```

#### ì‹œë‚˜ë¦¬ì˜¤ C: ëŒ€ê·œëª¨ Retrospective Screening
```
ë³‘ì› PACSì— ì €ì¥ëœ ê³¼ê±° CT ìŠ¤ìº”ë“¤
â†’ AIê°€ ìë™ìœ¼ë¡œ ì¬ë¶„ì„ (Batch Processing)
â†’ ë†“ì³¤ë˜ ì˜ì‹¬ ì†Œê²¬ ë°œê²¬
â†’ í•´ë‹¹ í™˜ìì—ê²Œ ì¶”ì  ê²€ì‚¬ ê¶Œìœ 
```

### AIì˜ í•µì‹¬ ì—­í• 

1. **Subtle Feature Detection**
   - ì‚¬ëŒ ëˆˆìœ¼ë¡œëŠ” êµ¬ë¶„í•˜ê¸° ì–´ë ¤ìš´ ë¯¸ì„¸í•œ texture ë³€í™”
   - ì·Œì¥ ê²½ê³„ì˜ irregularity
   - Parenchymal attenuationì˜ heterogeneity
   - ì·Œê´€ì˜ focal dilation (<3mm)

2. **Longitudinal Monitoring**
   - ë™ì¼ í™˜ìì˜ ê³¼ê±° CTì™€ ìë™ ë¹„êµ
   - ë§¤ìš° ëŠë¦° growth rateë„ ê°ì§€
   - ì •ìƒ ë³€ì´(normal variation)ì™€ pathologic change êµ¬ë¶„

3. **Multi-hospital Domain Adaptation**
   - ë³‘ì›ë§ˆë‹¤ ë‹¤ë¥¸ CT ì¥ë¹„, í”„ë¡œí† ì½œ
   - ê° ê¸°ê´€ì˜ ì •ìƒ ë¶„í¬ë¥¼ í•™ìŠµ
   - Domain shift ê·¹ë³µ

4. **Uncertainty Quantification**
   - Stage 1ì€ false positiveê°€ ë†’ì„ ìˆ˜ë°–ì— ì—†ìŒ
   - Confidence scoreì™€ í•¨ê»˜ ì¶”ì  ê´€ì°° ê¶Œì¥ ë¦¬í¬íŠ¸
   - "ì¦‰ì‹œ ì¶”ê°€ ê²€ì‚¬" vs "3ê°œì›” í›„ ì¬ê²€" êµ¬ë¶„

---

## ğŸ“Œ ì£¼ìš” íŠ¹ì§•

- **Opportunistic Screening**: ë‹¤ë¥¸ ëª©ì ìœ¼ë¡œ ì°ì€ CTì—ì„œ ì·Œì¥ ìë™ ë¶„ì„
- **Anomaly Detection**: ì •ìƒ ì·Œì¥ í•™ìŠµ í›„ ë¯¸ì„¸í•œ ì´ìƒ íŒ¨í„´ ê°ì§€
- **Longitudinal Analysis**: ì‹œê³„ì—´ CT ë¹„êµë¥¼ í†µí•œ progressive change íƒì§€
- **Multi-hospital Adaptation**: ë³‘ì›/ì¥ë¹„ ê°„ ì°¨ì´ë¥¼ ê·¹ë³µí•˜ëŠ” domain adaptation
- **Uncertainty Quantification**: ì‹ ë¢°ë„ ê¸°ë°˜ ì¶”ì  ê´€ì°° ë˜ëŠ” ì¦‰ì‹œ ì •ë°€ ê²€ì‚¬ ê¶Œì¥
- **ì™„ì „í•œ ëª¨ë“ˆí™”**: ì„¸ê·¸ë©˜í…Œì´ì…˜, ë¶„ë¥˜, ì´ìƒ íƒì§€ ëª¨ë“ˆì´ ë…ë¦½ì ìœ¼ë¡œ ì‹¤í–‰ ê°€ëŠ¥

---

## ğŸ”¬ CT Imaging ìµœì í™” ë° ê¸°ìˆ ì  ì ‘ê·¼

### Pancreas-Dedicated CT Protocol (ì´ìƒì ì¸ ê²½ìš°)

Stage 1 ì·Œì¥ì•”ì„ ë³´ë ¤ë©´ ì¼ë°˜ ë³µë¶€ CTë³´ë‹¤ ë” ì •ë°€í•œ í”„ë¡œí† ì½œì´ í•„ìš”í•©ë‹ˆë‹¤:

#### 1. Multi-phase Contrast Enhancement
```
Late Arterial Phase (Pancreatic Parenchymal Phase)
  - Timing: 40-50ì´ˆ
  - ì·Œì¥ ì‹¤ì§ˆì´ ê°€ì¥ ì˜ ë³´ì´ëŠ” ì‹œì 
  - ì‘ì€ ì¢…ì–‘ê³¼ ì •ìƒ ì¡°ì§ì˜ ëŒ€ë¹„ ìµœëŒ€í™”

Portal Venous Phase
  - Timing: 70-80ì´ˆ
  - ì£¼ë³€ í˜ˆê´€ í‰ê°€
  - í˜ˆê´€ ì¹¨ë²” ì—¬ë¶€ í™•ì¸

Delayed Phase (Optional)
  - Timing: 3-5ë¶„
  - ì¼ë¶€ hypovascular tumor ê°ì§€
```

#### 2. Thin-slice Acquisition
```
Slice Thickness: 0.5-1mm (ì¼ë°˜ CT: 3-5mm)
â†’ Partial volume effect ê°ì†Œ
â†’ ì‘ì€ ë³‘ë³€ ê°ì§€ìœ¨ í–¥ìƒ
â†’ 3D reconstruction í’ˆì§ˆ í–¥ìƒ
```

#### 3. High Resolution Settings
```
Matrix: 512x512 ì´ìƒ
Field of View: ì·Œì¥ì— ì§‘ì¤‘
Reconstruction: ì—¬ëŸ¬ ì•Œê³ ë¦¬ì¦˜ ì¡°í•©
```

### í˜„ì‹¤: ì¼ë°˜ ë³µë¶€ CTì—ì„œ ì‘ë™í•´ì•¼ í•¨

**í•˜ì§€ë§Œ ëŒ€ë¶€ë¶„ì˜ CTëŠ” ì´ë ‡ê²Œ ì°íˆì§€ ì•ŠìŠµë‹ˆë‹¤:**
- Single phase ë˜ëŠ” ê°„ë‹¨í•œ dual-phase
- 5mm slice thickness
- ì·Œì¥ì´ ì£¼ ëª©ì ì´ ì•„ë‹˜

**ë”°ë¼ì„œ ìš°ë¦¬ AIëŠ”:**
- âœ… **ìµœì ì´ ì•„ë‹Œ CTì—ì„œë„ ì‘ë™**í•´ì•¼ í•©ë‹ˆë‹¤
- âœ… **ë‹¤ì–‘í•œ í”„ë¡œí† ì½œì— robust**í•´ì•¼ í•©ë‹ˆë‹¤
- âœ… **ë³‘ì›ë§ˆë‹¤ ë‹¤ë¥¸ ì¥ë¹„/ì„¤ì •ì„ í•™ìŠµ**í•´ì•¼ í•©ë‹ˆë‹¤

---

## ğŸ§  ê¸°ìˆ ì  ì ‘ê·¼ë²•: Anomaly Detection

### ì™œ Anomaly Detectionì¸ê°€?

#### ë¬¸ì œ: ì•” ë°ì´í„° ë¶€ì¡±
```
ê³µê°œ ë°ì´í„°ì…‹ (NIH Pancreas-CT):
  - ì •ìƒ ì·Œì¥: 82ë¡€ âœ“
  - ì·Œì¥ì•”: 0ë¡€ âŒ

ì‹¤ì œ ì„ìƒ ë°ì´í„°:
  - ì •ìƒ/ì–‘ì„± ì§ˆí™˜: ìˆ˜ì‹­ë§Œ ê±´
  - Stage 1-2 ì·Œì¥ì•”: ìˆ˜ë°± ê±´ (ë§¤ìš° í¬ê·€)
```

#### í•´ê²°ì±…: ì •ìƒì„ ì™„ë²½íˆ í•™ìŠµ
```
"ì •ìƒì´ ì–´ë–¤ ê²ƒì¸ì§€ ì™„ë²½íˆ í•™ìŠµí•˜ë©´,
 ì •ìƒì´ ì•„ë‹Œ ê²ƒ(anomaly)ì„ ì°¾ì„ ìˆ˜ ìˆë‹¤"
```

### í•µì‹¬ ì•„ì´ë””ì–´

#### 1. U-Net ê¸°ë°˜ Autoencoder
```python
# ì •ìƒ ì·Œì¥ë§Œìœ¼ë¡œ í•™ìŠµ
Input: ì •ìƒ ì·Œì¥ CT
â†’ Encoder: íŠ¹ì§• ì••ì¶•
â†’ Decoder: ì›ë³¸ ë³µì›
Output: ë³µì›ëœ CT

Loss = MSE(Input, Output)
```

**ì •ìƒ ë°ì´í„° í•™ìŠµ í›„:**
- ì •ìƒ pancreas â†’ ì™„ë²½í•˜ê²Œ ë³µì› (low error)
- ì•”ì´ ìˆëŠ” pancreas â†’ ë³µì› ì‹¤íŒ¨ (high error)
- **High error region = Anomaly = ì˜ì‹¬ ë¶€ìœ„**

#### 2. Weighted Reconstruction Loss
```python
# ì·Œì¥ ì˜ì—­ì— ë” ë†’ì€ ê°€ì¤‘ì¹˜
Loss = weighted_MSE(Input, Output, pancreas_mask)

pancreas ì˜ì—­: weight = 10.0
background: weight = 1.0
```

**ì´ìœ :**
- ì‘ì€ ì¢…ì–‘(1cm ë¯¸ë§Œ)ë„ ë†“ì¹˜ì§€ ì•Šê¸° ìœ„í•´
- ì·Œì¥ ë‚´ë¶€ì˜ subtle changeì— ì§‘ì¤‘
- Background noiseëŠ” ë¬´ì‹œ

#### 3. Multi-scale Feature Analysis
```
ì—¬ëŸ¬ í•´ìƒë„ì—ì„œ ë™ì‹œì— ë¶„ì„:
- High resolution: ì‘ì€ ì¢…ì–‘ (<1cm)
- Medium resolution: texture pattern
- Low resolution: ì „ì²´ì ì¸ í˜•íƒœ ë³€í™”
```

#### 4. Temporal Consistency (í–¥í›„ ê³„íš)
```
ë™ì¼ í™˜ìì˜ ê³¼ê±° CTì™€ ë¹„êµ:
- t0: ì •ìƒ (baseline)
- t1: ë¯¸ì„¸í•œ ë³€í™” (AI ê°ì§€)
- t2: ëª…í™•í•œ ë³€í™” (í™•ì§„)

â†’ Progressive change pattern í•™ìŠµ
â†’ False positive ê°ì†Œ
```

### Expected Output Example

```json
{
  "patient_id": "P001234",
  "scan_date": "2025-10-15",
  "anomaly_detected": true,
  "anomaly_score": 0.73,
  "recommendation": "ì·Œì¥ ì „ìš© CT ë˜ëŠ” MRI ê¶Œì¥",
  "confidence": "medium-high",
  "region_of_interest": {
    "location": "pancreatic body",
    "size_estimate": "8-12mm",
    "reconstruction_error": 0.089
  },
  "follow_up": {
    "urgency": "non-urgent",
    "suggested_interval": "3 months",
    "reason": "subtle texture heterogeneity without definite mass"
  }
}
```

---

## ğŸ—ï¸ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
pancreas_cancer_diagnosis/
â”œâ”€â”€ segmentation/           # 5ê°œ ì„¸ê·¸ë©˜í…Œì´ì…˜ CNN (ë…ë¦½ ëª¨ë“ˆ)
â”‚   â”œâ”€â”€ models/            # UNet, ResUNet, VNet, AttentionUNet, C2FNAS
â”‚   â”œâ”€â”€ training/          # ë…ë¦½ ì‹¤í–‰ í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸
â”‚   â””â”€â”€ inference/         # ë…ë¦½ ì‹¤í–‰ ì¶”ë¡  ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ classification/         # ë¶„ë¥˜ CNN (ë…ë¦½ ëª¨ë“ˆ)
â”‚   â”œâ”€â”€ models/            # ResNet3D, DenseNet3D, Ensemble
â”‚   â”œâ”€â”€ training/          # ë…ë¦½ ì‹¤í–‰ í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸
â”‚   â””â”€â”€ inference/         # ë…ë¦½ ì‹¤í–‰ ì¶”ë¡  ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ pipeline/              # End-to-end ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°
â”‚   â”œâ”€â”€ orchestrator.py    # ë©”ì¸ íŒŒì´í”„ë¼ì¸ ì»¨íŠ¸ë¡¤ëŸ¬
â”‚   â””â”€â”€ inference.py       # End-to-end ì¶”ë¡  ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ data/                  # ê³µìœ  ë°ì´í„° ë¡œë”
â”‚   â”œâ”€â”€ dataset.py         # PyTorch ë°ì´í„°ì…‹
â”‚   â””â”€â”€ datamodule.py      # Lightning ë°ì´í„° ëª¨ë“ˆ
â”œâ”€â”€ utils/                 # ìœ í‹¸ë¦¬í‹°
â””â”€â”€ configs/               # ì„¤ì • íŒŒì¼ í…œí”Œë¦¿
    â”œâ”€â”€ segmentation/      # ê° ì„¸ê·¸ë©˜í…Œì´ì…˜ ëª¨ë¸ ì„¤ì •
    â”œâ”€â”€ classification/    # ë¶„ë¥˜ ëª¨ë¸ ì„¤ì •
    â””â”€â”€ pipeline/          # End-to-end íŒŒì´í”„ë¼ì¸ ì„¤ì •
```

## ğŸš€ ì„¤ì¹˜

```bash
# ì €ì¥ì†Œ í´ë¡ 
git clone <your-repo-url>
cd end_to_end_workflow

# íŒ¨í‚¤ì§€ ì„¤ì¹˜
pip install -r requirements.txt

# ë˜ëŠ” ê°œë°œ ëª¨ë“œë¡œ ì„¤ì¹˜
pip install -e .
```

## ğŸ’¡ ì‚¬ìš©ë²•

### 1. ì„¸ê·¸ë©˜í…Œì´ì…˜ ëª¨ë¸ í•™ìŠµ (ë…ë¦½ ì‹¤í–‰)

5ê°œì˜ ì„¸ê·¸ë©˜í…Œì´ì…˜ ëª¨ë¸ì„ ê°ê° ë…ë¦½ì ìœ¼ë¡œ í•™ìŠµ:

```bash
# UNet í•™ìŠµ (ëª¨ë¸ 1/5)
python -m pancreas_cancer_diagnosis.segmentation.training.train \
    --config pancreas_cancer_diagnosis/configs/segmentation/unet_example.yaml \
    --model unet \
    --gpus 4 \
    --seed 42

# ResUNet í•™ìŠµ (ëª¨ë¸ 2/5)
python -m pancreas_cancer_diagnosis.segmentation.training.train \
    --config pancreas_cancer_diagnosis/configs/segmentation/resunet_example.yaml \
    --model resunet \
    --gpus 4 \
    --seed 42

# ë§ˆì°¬ê°€ì§€ë¡œ vnet, attention_unet, c2fnasë„ í•™ìŠµ...
```

ê° ëª¨ë¸ì€ ë…ë¦½ì ìœ¼ë¡œ í•™ìŠµë˜ë©° ì²´í¬í¬ì¸íŠ¸ë¥¼ `outputs/segmentation/<model_name>/`ì— ì €ì¥í•©ë‹ˆë‹¤.

### 2. ì„¸ê·¸ë©˜í…Œì´ì…˜ ì¶œë ¥ ìƒì„±

í•™ìŠµ í›„, ë¶„ë¥˜ë¥¼ ìœ„í•œ ì„¸ê·¸ë©˜í…Œì´ì…˜ ë§ˆìŠ¤í¬ë¥¼ ìƒì„±:

```bash
python -m pancreas_cancer_diagnosis.segmentation.inference.inference \
    --model unet \
    --checkpoint outputs/segmentation/unet/checkpoints/best.pth \
    --input_dir data/ct_images \
    --output_dir data/segmentations/unet
```

5ê°œ ëª¨ë¸ ëª¨ë‘ì— ëŒ€í•´ ë°˜ë³µí•˜ì—¬ 5ì„¸íŠ¸ì˜ ì„¸ê·¸ë©˜í…Œì´ì…˜ ë§ˆìŠ¤í¬ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

### 3. ë¶„ë¥˜ ëª¨ë¸ í•™ìŠµ (ë…ë¦½ ì‹¤í–‰)

ì„¸ê·¸ë©˜í…Œì´ì…˜ ì¶œë ¥ìœ¼ë¡œ ë¶„ë¥˜ ëª¨ë¸ í•™ìŠµ:

```bash
# UNet ì„¸ê·¸ë©˜í…Œì´ì…˜ìœ¼ë¡œ ë¶„ë¥˜ê¸° 1 í•™ìŠµ
python -m pancreas_cancer_diagnosis.classification.training.train \
    --config pancreas_cancer_diagnosis/configs/classification/resnet3d_example.yaml \
    --model resnet3d \
    --gpus 1 \
    --use_segmentation \
    --seed 42

# ResUNet ì„¸ê·¸ë©˜í…Œì´ì…˜ìœ¼ë¡œ ë¶„ë¥˜ê¸° 2 í•™ìŠµ
# ... 5ê°œ ëª¨ë‘ ë°˜ë³µ
```

### 4. End-to-End ì¶”ë¡ 

ìƒˆë¡œìš´ CT ìŠ¤ìº”ì— ëŒ€í•´ ì „ì²´ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰:

```bash
python -m pancreas_cancer_diagnosis.pipeline.inference \
    --config pancreas_cancer_diagnosis/configs/pipeline/inference_example.yaml \
    --input data/test_patient_001.nii.gz \
    --output results/patient_001 \
    --save_segmentations
```

**ì¶œë ¥ ì˜ˆì‹œ:**
```json
{
  "input_file": "data/test_patient_001.nii.gz",
  "prediction": 1,
  "diagnosis": "ì•”",
  "probabilities": {
    "ì •ìƒ": 0.23,
    "ì•”": 0.77
  },
  "uncertainty": {
    "ì •ìƒ": 0.05,
    "ì•”": 0.05
  }
}
```

## ğŸ“Š ì›Œí¬í”Œë¡œìš°

### ì „ì²´ í•™ìŠµ íŒŒì´í”„ë¼ì¸

1. **ë°ì´í„° ì¤€ë¹„**
   - CT ìŠ¤ìº”ì„ NIfTI í¬ë§·(`.nii.gz`)ìœ¼ë¡œ ë³€í™˜
   - train/val/test ë¶„í• ì´ í¬í•¨ëœ `datalist.json` ìƒì„±

2. **5ê°œ ì„¸ê·¸ë©˜í…Œì´ì…˜ ëª¨ë¸ í•™ìŠµ**
   ```bash
   for model in unet resunet vnet attention_unet c2fnas; do
       python -m pancreas_cancer_diagnosis.segmentation.training.train \
           --config configs/segmentation/${model}.yaml \
           --model ${model} \
           --seed 42
   done
   ```

3. **ì„¸ê·¸ë©˜í…Œì´ì…˜ ì¶œë ¥ ìƒì„±**
   ```bash
   # ë°ì´í„°ì…‹ì— ëŒ€í•´ 5ê°œ ëª¨ë¸ ëª¨ë‘ë¡œ ì¶”ë¡  ì‹¤í–‰
   ```

4. **5ê°œ ë¶„ë¥˜ ëª¨ë¸ í•™ìŠµ**
   ```bash
   # ê° ì„¸ê·¸ë©˜í…Œì´ì…˜ ì¶œë ¥ë§ˆë‹¤ í•˜ë‚˜ì˜ ë¶„ë¥˜ê¸° í•™ìŠµ
   ```

5. **End-to-End ì¶”ë¡  ì‹¤í–‰**
   ```bash
   # ìµœì¢… ì§„ë‹¨ì„ ìœ„í•œ ì „ì²´ íŒŒì´í”„ë¼ì¸ ì‚¬ìš©
   ```

## ğŸ”§ ì„¤ì •

ëª¨ë“  ì„¤ì •ì€ YAML í˜•ì‹ ì‚¬ìš©:

### ì„¸ê·¸ë©˜í…Œì´ì…˜ ì„¤ì •
```yaml
model:
  in_channels: 1
  num_classes: 3

data:
  data_root: "/path/to/data"
  batch_size: 2

training:
  learning_rate: 0.001
  max_epochs: 100
```

### íŒŒì´í”„ë¼ì¸ ì„¤ì •
```yaml
segmentation_models:
  - type: "unet"
    checkpoint: "path/to/unet.pth"
  # ... 4ê°œ ë”

classification_models:
  - type: "resnet3d"
    checkpoint: "path/to/classifier.pth"
  # ... 4ê°œ ë”

ensemble_method: "weighted"
ensemble_weights: [0.25, 0.20, 0.20, 0.20, 0.15]
```

## ğŸ¯ ì¬í˜„ì„±

í”„ë ˆì„ì›Œí¬ì—ëŠ” ì¬í˜„ì„±ì„ ë³´ì¥í•˜ëŠ” ë„êµ¬ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤:

```python
from pancreas_cancer_diagnosis.pipeline.orchestrator import ReproducibilityManager

# ì‹¤í—˜ ì„¤ì • ì¶”ì 
repro_manager = ReproducibilityManager(experiment_dir="experiments/run_001")

# ê° ëª¨ë¸ ì„¤ì • ë¡œê¹…
repro_manager.log_segmentation_config(model_idx=0, config=model_config)
repro_manager.log_results(split="test", metrics=test_metrics)

# ëª¨ë“  ì •ë³´ ì €ì¥
repro_manager.save_experiment_info()
```

## ğŸ”‘ í•µì‹¬ ì„¤ê³„ ì›ì¹™

### 1. ëª¨ë“ˆí™”
ê° ëª¨ë“ˆ(ì„¸ê·¸ë©˜í…Œì´ì…˜, ë¶„ë¥˜)ì€ ì™„ì „íˆ ë…ë¦½ì :
- ìì²´ ëª¨ë¸, í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸, ì¶”ë¡  ìŠ¤í¬ë¦½íŠ¸ ë³´ìœ 
- ê°œë³„ì ìœ¼ë¡œ ê°œë°œ ë° í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
- ìƒˆë¡œìš´ ëª¨ë¸ ì¶”ê°€ ìš©ì´

### 2. ìœ ì—°ì„±
- **ëª¨ë¸ ì‰½ê²Œ êµì²´**: ëª¨ë“  ëª¨ë¸ì´ ë² ì´ìŠ¤ í´ë˜ìŠ¤ ìƒì†
- **ë‹¤ì–‘í•œ ì•™ìƒë¸” ì „ëµ**: Average, weighted, voting, stacking
- **ì„¤ì • ê°€ëŠ¥**: YAML ì„¤ì •ìœ¼ë¡œ ëª¨ë“  ê²ƒ ì œì–´

### 3. ìœ ì§€ë³´ìˆ˜ì„±
- **ëª…í™•í•œ ì¸í„°í˜ì´ìŠ¤**: ë² ì´ìŠ¤ í´ë˜ìŠ¤ê°€ ê³„ì•½ ì •ì˜
- **ê´€ì‹¬ì‚¬ ë¶„ë¦¬**: ë°ì´í„°, ëª¨ë¸, í•™ìŠµ, ì¶”ë¡ ì´ ë¶„ë¦¬ë¨
- **íƒ€ì… íŒíŠ¸ì™€ ë¬¸ì„œí™”**: ì´í•´í•˜ê³  í™•ì¥í•˜ê¸° ì‰¬ì›€

### 4. ë…ë¦½ ì‹¤í–‰
ê° ì»´í¬ë„ŒíŠ¸ë¥¼ ë…ë¦½ì ìœ¼ë¡œ ì‹¤í–‰ ê°€ëŠ¥:
- ë¶„ë¥˜ ì—†ì´ ì„¸ê·¸ë©˜í…Œì´ì…˜ë§Œ í•™ìŠµ
- ì „ì²´ íŒŒì´í”„ë¼ì¸ ì—†ì´ ë¶„ë¥˜ë§Œ í•™ìŠµ
- ëª¨ë¸ì˜ ì–´ë–¤ ì¡°í•©ì´ë“  ì‚¬ìš© ê°€ëŠ¥

## ğŸ”¨ í”„ë ˆì„ì›Œí¬ í™•ì¥

### ìƒˆë¡œìš´ ì„¸ê·¸ë©˜í…Œì´ì…˜ ëª¨ë¸ ì¶”ê°€

1. `BaseSegmentationModel`ì„ ìƒì†í•˜ëŠ” ìƒˆ ëª¨ë¸ ìƒì„±:
```python
# pancreas_cancer_diagnosis/segmentation/models/my_model.py
from .base import BaseSegmentationModel

class MyNewModel(BaseSegmentationModel):
    def __init__(self, in_channels=1, num_classes=3, **kwargs):
        super().__init__(in_channels, num_classes, **kwargs)
        # ì—¬ê¸°ì— ì•„í‚¤í…ì²˜ êµ¬í˜„

    def forward(self, x):
        # ì—¬ê¸°ì— forward pass êµ¬í˜„
        return output
```

2. `__init__.py`ì— ë“±ë¡
3. ì„¤ì • í…œí”Œë¦¿ ì¶”ê°€
4. ë…ë¦½ì ìœ¼ë¡œ í•™ìŠµ!

### ìƒˆë¡œìš´ ì•™ìƒë¸” ì „ëµ ì¶”ê°€

`EnsembleClassifier` í™•ì¥:
```python
def _my_ensemble_method(self, predictions):
    # ì»¤ìŠ¤í…€ ì•™ìƒë¸” ë¡œì§
    return combined_predictions
```

## ğŸ“ ì¸ìš©

ì—°êµ¬ì—ì„œ ì´ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ì‹œë©´ ë‹¤ìŒê³¼ ê°™ì´ ì¸ìš©í•´ì£¼ì„¸ìš”:

```bibtex
@software{pancreas_cancer_diagnosis,
  title = {ì·Œì¥ì•” ì§„ë‹¨: End-to-End íŒŒì´í”„ë¼ì¸},
  author = {Your Name},
  year = {2025},
  url = {https://github.com/yourusername/end_to_end_workflow}
}
```

## ğŸ“„ ë¼ì´ì„ ìŠ¤

MIT License

## ğŸ¤ ê¸°ì—¬

ê¸°ì—¬ë¥¼ í™˜ì˜í•©ë‹ˆë‹¤! ëª¨ë“ˆí™”ëœ ì„¤ê³„ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ì‘ì—…ì´ ì‰½ìŠµë‹ˆë‹¤:
- ìƒˆë¡œìš´ ëª¨ë¸ ì¶”ê°€
- ê¸°ì¡´ ì•„í‚¤í…ì²˜ ê°œì„ 
- ìƒˆë¡œìš´ ì•™ìƒë¸” ì „ëµ ì¶”ê°€
- ë°ì´í„° ë¡œë” ê°œì„ 

ì´ìŠˆë‚˜ í’€ ë¦¬í€˜ìŠ¤íŠ¸ë¥¼ ì—´ì–´ì£¼ì„¸ìš”.

## ğŸ“§ ì—°ë½ì²˜

ì§ˆë¬¸ì´ë‚˜ ë¬¸ì œê°€ ìˆìœ¼ì‹œë©´ GitHub ì´ìŠˆë¥¼ ì—´ê±°ë‚˜ [your-email@example.com]ìœ¼ë¡œ ì—°ë½ì£¼ì„¸ìš”.
